{"ast":null,"code":"var _jsxFileName = \"/Users/khuong/Desktop/2022/ReactJS/r3f-audio-analyser-forked/src/App.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$(),\n    _s6 = $RefreshSig$(),\n    _s7 = $RefreshSig$(),\n    _s8 = $RefreshSig$();\n\nimport * as THREE from \"three\";\nimport React, { Suspense, useRef, useEffect, useLayoutEffect } from \"react\";\nimport { Canvas, useFrame, useThree } from \"@react-three/fiber\";\nimport { Sphere, PositionalAudio, OrbitControls, MeshReflectorMaterial, Environment, useTexture, useDepthBuffer, SpotLight, Text, Stats, CameraShake, Html, Loader, Billboard } from \"@react-three/drei\";\nimport lerp from \"@14islands/lerp\";\nimport { useControls, Leva } from \"leva\";\nimport { a, useSpring } from \"@react-spring/three\";\nimport Effects from \"./Effects\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet max = 0;\n\nfunction Analyzer(_ref) {\n  _s();\n\n  let {\n    started,\n    onStartRequest,\n    sound,\n    shakeController\n  } = _ref;\n  // <Analyzer /> will not run before everything else in the suspense block is resolved.\n  // That means <PositionalAudio/>, which executes async, is ready by the time we're here.\n  // The next frame (useEffect) is guaranteed(!) to access positional-audios ref.\n  const mesh = useRef();\n  const mesh2 = useRef();\n  const mesh3 = useRef();\n  const analyser = useRef();\n  const eq = useRef(); // const [hasStarted, setStarted] = React.useState(false);\n\n  const [hover, setHover] = React.useState(false);\n  const {\n    shake\n  } = useControls(\"camera\", {\n    shake: true\n  });\n  const onClick = React.useCallback(() => {\n    // introBackdrop.current.visible = false;\n    //setStarted(true);\n    //started && shakeController.current.setIntensity(0.7);\n    onStartRequest && onStartRequest();\n  }, [started, shakeController]);\n  useEffect(() => {\n    analyser.current = new THREE.AudioAnalyser(sound.current, 32);\n    eq.current = document.querySelector(\".eq\");\n  }, [sound]);\n  useFrame((_, delta) => {\n    const data = analyser.current.getAverageFrequency();\n    const data2 = analyser.current.getFrequencyData();\n    /*\n      mesh.current.material.color.setRGB(\n        Math.min(1, (data2[1] / 255) * 1),\n        Math.min(1, (data2[6] / 255) * 2),\n        Math.min(1, (data2[10] / 255) * 15)\n      );\n      */\n\n    const avg = data / 255;\n    const pulse = Math.pow(data * 0.01, 2);\n\n    if (shake) {\n      shakeController.current.setIntensity(pulse * 0.2);\n    }\n\n    eq.current.style.transform = `scaleY(${pulse * avg})`;\n\n    if (analyser.current && started) {\n      mesh.current.material.color.setRGB(avg * 1, 0, 0);\n      mesh.current.material.roughness = avg;\n      mesh.current.material.metalness = 0 + avg; // mesh.current.scale.setScalar(avg2 * 1.2);\n      // mesh.current.scale.setScalar(1 + pulse * pulse);\n\n      if (mesh.current.scale.x > 1.9) {\n        mesh.current.scale.setScalar(2 + pulse * 0.14);\n      }\n\n      window.intensity = avg; // shakeController.current.setIntensity(avg2 * 0.1);\n      // console.log('data2', data2)\n      // console.log(\"base\", data);\n      // mesh.current.scale.setScalar(\n      //   lerp(mesh.current.scale.x, (data / 255) * 5, 0.01, delta)\n      // );\n\n      mesh2.current.position.x = lerp(mesh2.current.position.x, data2[2] / 255 * 3 + 1, 0.02, delta);\n      mesh2.current.position.z = lerp(mesh2.current.position.z, data2[6] / 255 * 2 - 1, 0.02, delta);\n      mesh3.current.position.x = lerp(mesh3.current.position.x, data2[7] / 255 * -2 - 1, 0.02, delta);\n      mesh3.current.position.z = lerp(mesh3.current.position.z, data2[11] / 255 * 2 + 0.5, 0.02, delta); // 7 snare\n\n      if (data > max) {\n        max = data; // console.log(\"data\", data, analyser.current.getFrequencyData());\n      }\n    }\n  });\n  const sphereSpring = useSpring({\n    \"position-y\": started ? 2.5 : 0.5,\n    \"position-z\": started ? -1 : -0.5,\n    scale: started ? 2 : 1,\n    config: {\n      tension: 10,\n      friction: 10\n    },\n    delay: 1000\n  });\n  const colorSpring = useSpring({\n    \"material-color\": hover ? \"#55ff99\" : \"#C6DA20\",\n    config: {\n      tension: 200,\n      friction: 100\n    }\n  });\n  useEffect(() => {\n    document.body.style.cursor = hover && !started ? \"pointer\" : \"auto\";\n  }, [hover]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false);\n}\n\n_s(Analyzer, \"hGk0MOx+pRKSIWhf1eXjLK8TIM8=\", false, function () {\n  return [useControls, useFrame, useSpring, useSpring];\n});\n\n_c = Analyzer;\n\nfunction PlaySound(_ref2) {\n  _s2();\n\n  let {\n    onStartRequest,\n    seek = 0,\n    started,\n    shakeController,\n    url\n  } = _ref2;\n  // This component creates a suspense block, blocking execution until\n  // all async tasks (in this case PositionAudio) have been resolved.\n  const sound = useRef();\n  useLayoutEffect(() => {\n    if (!started) return;\n    console.log(\"started!\");\n    sound.current.play();\n  }, [started]);\n  useEffect(() => {\n    // not a real seek - just jumping forward a bit\n    if (!sound.current) return; // console.log(\"seek\", seek, sound.current);\n\n    sound.current.pause();\n    sound.current.offset = seek;\n    sound.current.play();\n  }, [seek]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(PositionalAudio, {\n      distance: 10,\n      url: url,\n      ref: sound\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Analyzer, {\n      started: started,\n      onStartRequest: onStartRequest,\n      sound: sound,\n      shakeController: shakeController\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Lights, {\n      started: started\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s2(PlaySound, \"2gmNic3qaWjl6qG/uOZv8LrFX1U=\");\n\n_c2 = PlaySound;\n\nfunction Ground(props) {\n  _s3();\n\n  const t = useTexture(\"water-rough1.jpeg\");\n  const f = useTexture(\"floor.jpeg\");\n  const groundProps = useControls(\"ground\", {\n    color: \"#fff\",\n    roughness: {\n      value: 1,\n      min: 0,\n      max: 1,\n      steps: 0.01\n    },\n    metalness: {\n      value: 0.9,\n      min: 0,\n      max: 1,\n      steps: 0.01\n    },\n    envMapIntensity: {\n      value: 0.01,\n      min: 0,\n      max: 1,\n      steps: 0.01\n    },\n    blur: {\n      value: 512,\n      min: 0,\n      max: 1024,\n      steps: 16\n    },\n    mixBlur: {\n      value: 4,\n      min: 0,\n      max: 100,\n      steps: 0.1\n    },\n    mixStrength: {\n      value: 2,\n      min: 0,\n      max: 10,\n      steps: 0.1\n    },\n    mixContrast: {\n      value: 1.0,\n      min: 0,\n      max: 10,\n      steps: 0.1\n    },\n    mirror: {\n      value: 0.33,\n      min: 0,\n      max: 1,\n      steps: 0.1\n    }\n  });\n  useLayoutEffect(() => {\n    t.wrapS = THREE.RepeatWrapping;\n    t.wrapT = THREE.RepeatWrapping;\n    t.repeat.set(5, 5);\n    t.needsUpdate = true;\n  }, [t]);\n  return /*#__PURE__*/_jsxDEV(\"mesh\", {\n    \"rotation-x\": Math.PI * -0.5,\n    \"position-y\": 0,\n    receiveShadow: true,\n    ...props,\n    children: [/*#__PURE__*/_jsxDEV(\"circleGeometry\", {\n      args: [17, 64]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MeshReflectorMaterial, {\n      roughnessMap: t,\n      resolution: 2048,\n      ...groundProps,\n      // color=\"#fff\"\n      // roughnessMap={t}\n      // roughness={1}\n      // metalness={0.9}\n      // envMapIntensity={0.01}\n      // blur={512} // Blur ground reflections (width, heigt), 0 skips blur\n      // mixBlur={10} // How much blur mixes with surface roughness (default = 1)\n      // mixStrength={0.5} // Strength of the reflections\n      // mixContrast={1} // Contrast of the reflections\n      // resolution={2048} // Off-buffer resolution, lower=faster, higher=better quality, slower\n      // mirror={0.5} // Mirror environment, 0 = texture colors, 1 = pick up env colors\n      // depthScale={0} // Scale the depth factor (0 = no depth, default = 0)\n      // minDepthThreshold={0.9} // Lower edge for the depthTexture interpolation (default = 0)\n      // maxDepthThreshold={1} // Upper edge for the depthTexture interpolation (default = 0)\n      // depthToBlurRatioBias={0} // Adds a bias factor to the depthTexture before calculating the blur amount [blurFactor = blurTexture * (depthTexture + bias)]. It accepts values between 0 and 1, default is 0.25. An amount > 0 of bias makes sure that the blurTexture is not too sharp because of the multiplication with the depthTexture\n      //distortion={1} // Amount of distortion based on the distortionMap texture\n      //distortionMap={distortionTexture} // The red channel of this texture is used as the distortion map. Default is null\n      debug: 0\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 220,\n    columnNumber: 5\n  }, this);\n}\n\n_s3(Ground, \"FtqIS63ZRKjfDiw217oM+9oJECA=\", false, function () {\n  return [useTexture, useTexture, useControls];\n});\n\n_c3 = Ground;\n\nfunction Lights(_ref3) {\n  _s4();\n\n  let {\n    started\n  } = _ref3;\n  // This is a super cheap depth buffer that only renders once (frames: 1 is optional!), which works well for static scenes\n  // Spots can optionally use that for realism, learn about soft particles here: http://john-chapman-graphics.blogspot.com/2013/01/good-enough-volumetrics-for-spotlights.html\n  const depthBuffer = useDepthBuffer({\n    size: 512\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(MovingSpot, {\n      depthBuffer: depthBuffer,\n      color: \"#0c8cbf\",\n      position: [4, 5, 2],\n      started: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MovingSpot, {\n      depthBuffer: depthBuffer,\n      color: \"#DE356A\",\n      position: [-4, 5, 2],\n      started: started\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s4(Lights, \"I4r8VZffKykJieUufPlEHQJy2MM=\", false, function () {\n  return [useDepthBuffer];\n});\n\n_c4 = Lights;\n\nfunction MovingSpot(_ref4) {\n  _s5();\n\n  let {\n    started,\n    vec = new THREE.Vector3(),\n    ...props\n  } = _ref4;\n  const light = useRef();\n  const viewport = useThree(state => state.viewport);\n  useFrame(state => {\n    light.current.target.position.lerp(vec.set(!started ? -8 : state.mouse.x * viewport.width / 2, state.mouse.y * viewport.height / 2, -1), 0.02);\n    light.current.target.updateMatrixWorld();\n  });\n  return /*#__PURE__*/_jsxDEV(SpotLight, {\n    castShadow: true,\n    ref: light,\n    penumbra: 1 // distance={5}\n    ,\n    distance: 10 // decay={0}\n    ,\n    decay: 0.5,\n    angle: 0.25,\n    attenuation: 6,\n    anglePower: 5,\n    intensity: 5 // shadow-camera-far={100}\n    // shadow-camera-fov={80}\n    ,\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 294,\n    columnNumber: 5\n  }, this);\n}\n\n_s5(MovingSpot, \"vKikLve0vOITF/mxc0VrbPLa2Uo=\", false, function () {\n  return [useThree, useFrame];\n});\n\n_c5 = MovingSpot;\n\nfunction Background(_ref5) {\n  _s6();\n\n  let {\n    color = \"#202020\"\n  } = _ref5;\n  const gl = useThree(s => s.gl);\n  const bgColor = React.useMemo(() => {\n    const c = new THREE.Color(color).convertSRGBToLinear();\n    gl.setClearColor(c, 1.0);\n    return c;\n  }, [color, gl]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"color\", {\n      attach: \"background\",\n      args: [bgColor]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"fog\", {\n      attach: \"fog\",\n      args: [bgColor, 5, 10]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s6(Background, \"YlctGMW6ja/Sjohaj2W/FyrbE50=\", false, function () {\n  return [useThree];\n});\n\n_c6 = Background;\n\nfunction CameraParallax(_ref6) {\n  _s7();\n\n  let {\n    started,\n    controls,\n    parallax = 1\n  } = _ref6;\n  const camera = useThree(s => s.camera); // const controls = useThree((s) => s.controls);\n\n  const get = useThree(_ref7 => {\n    let {\n      get\n    } = _ref7;\n    return get;\n  }); // console.log(\"controls\", controls, get().controls);\n\n  useFrame((state, delta) => {\n    // console.log(\"c\", controls.current);\n    if (parallax && controls.current) {\n      controls.current.target.x = lerp(controls.current.target.x, !started ? -8 : 0, 0.02, delta);\n      camera.position.x = lerp(camera.position.x, !started ? -5 : state.mouse.x * parallax + 2, 0.02, delta);\n      camera.position.y = lerp(camera.position.y, 3 + state.mouse.y * parallax, 0.02, delta); // controls.current.update();\n    }\n  });\n  return null;\n}\n\n_s7(CameraParallax, \"qPG+NBgYpGYWzM1nSmF0QRZbl4E=\", false, function () {\n  return [useThree, useThree, useFrame];\n});\n\n_c7 = CameraParallax;\nexport default function App() {\n  _s8();\n\n  const controls = useRef();\n  const shakeController = useRef(); // const [hasStarted, setStarted] = React.useState(false);\n\n  const [isUnwrapped, setUnwrap] = React.useState(false);\n  const [seek, setSeek] = React.useState(0);\n  const config = {\n    maxYaw: 0,\n    // Max amount camera can yaw in either direction\n    maxPitch: 0.05,\n    // Max amount camera can pitch in either direction\n    maxRoll: 0.05,\n    // Max amount camera can roll in either direction\n    yawFrequency: 0,\n    // Frequency of the the yaw rotation\n    pitchFrequency: 5,\n    // Frequency of the pitch rotation\n    rollFrequency: 0.1,\n    // Frequency of the roll rotation\n    intensity: 0,\n    // initial intensity of the shake\n    decay: true,\n    // should the intensity decay over time\n    decayRate: 0.9,\n    // if decay = true this is the rate at which intensity will reduce at\n    controls // if using orbit controls, pass a ref here so we can update the rotation\n\n  }; // const textSpring = useSpring({\n  //   \"position-y\": true ? 0 : 5,\n  //   config: { tension: 10000, friction: 100 },\n  //   delay: 3000\n  // });\n\n  const {\n    fps\n  } = useControls({\n    fps: false\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Canvas, {\n      shadows: true,\n      dpr: [1, 1.2],\n      camera: {\n        position: [-5, 3, 6],\n        fov: 50,\n        near: 1,\n        far: 20\n      },\n      gl: {\n        antialias: false,\n        alpha: false\n      },\n      children: [/*#__PURE__*/_jsxDEV(Background, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Suspense, {\n        fallback: null,\n        children: [/*#__PURE__*/_jsxDEV(PlaySound, {\n          seek: seek,\n          shakeController: shakeController //url=\"https://14islands-assets.netlify.app/assets/Kollektiv_Turmstrasse_-_Grillen_Im_Garten_Original_mix.mp3\"\n          ,\n          url: \"https://14islands-assets.netlify.app/assets/Kollektiv_Turmstrasse_-_Affekt_Original_mix_(djlist.net).mp3\",\n          started: isUnwrapped,\n          onStartRequest: () => setUnwrap(true)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(OrbitControls, {\n          ref: controls,\n          target: [-10, 1.8, 0],\n          enableZoom: false,\n          autoRotate: false,\n          enableRotate: false,\n          enablePan: false // makeDefault\n\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CameraShake, {\n          ref: shakeController,\n          ...config\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CameraParallax, {\n          controls: controls,\n          started: isUnwrapped\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 421,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Ground, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Environment, {\n          preset: \"warehouse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 9\n      }, this), fps && /*#__PURE__*/_jsxDEV(Stats, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Effects, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Leva, {\n      collapsed: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `playing ${isUnwrapped ? \"started\" : \"\"}`,\n      onClick: () => {\n        setSeek(120);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"eq\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: \"Kollektiv Turmstrasse\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this), \" - Affekt (Original mix)\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s8(App, \"25paos1DZtHTakI6vf+L51K0/o4=\", false, function () {\n  return [useControls];\n});\n\n_c8 = App;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8;\n\n$RefreshReg$(_c, \"Analyzer\");\n$RefreshReg$(_c2, \"PlaySound\");\n$RefreshReg$(_c3, \"Ground\");\n$RefreshReg$(_c4, \"Lights\");\n$RefreshReg$(_c5, \"MovingSpot\");\n$RefreshReg$(_c6, \"Background\");\n$RefreshReg$(_c7, \"CameraParallax\");\n$RefreshReg$(_c8, \"App\");","map":{"version":3,"names":["THREE","React","Suspense","useRef","useEffect","useLayoutEffect","Canvas","useFrame","useThree","Sphere","PositionalAudio","OrbitControls","MeshReflectorMaterial","Environment","useTexture","useDepthBuffer","SpotLight","Text","Stats","CameraShake","Html","Loader","Billboard","lerp","useControls","Leva","a","useSpring","Effects","max","Analyzer","started","onStartRequest","sound","shakeController","mesh","mesh2","mesh3","analyser","eq","hover","setHover","useState","shake","onClick","useCallback","current","AudioAnalyser","document","querySelector","_","delta","data","getAverageFrequency","data2","getFrequencyData","avg","pulse","Math","pow","setIntensity","style","transform","material","color","setRGB","roughness","metalness","scale","x","setScalar","window","intensity","position","z","sphereSpring","config","tension","friction","delay","colorSpring","body","cursor","PlaySound","seek","url","console","log","play","pause","offset","Ground","props","t","f","groundProps","value","min","steps","envMapIntensity","blur","mixBlur","mixStrength","mixContrast","mirror","wrapS","RepeatWrapping","wrapT","repeat","set","needsUpdate","PI","Lights","depthBuffer","size","MovingSpot","vec","Vector3","light","viewport","state","target","mouse","width","y","height","updateMatrixWorld","Background","gl","s","bgColor","useMemo","c","Color","convertSRGBToLinear","setClearColor","CameraParallax","controls","parallax","camera","get","App","isUnwrapped","setUnwrap","setSeek","maxYaw","maxPitch","maxRoll","yawFrequency","pitchFrequency","rollFrequency","decay","decayRate","fps","fov","near","far","antialias","alpha"],"sources":["/Users/khuong/Desktop/2022/ReactJS/r3f-audio-analyser-forked/src/App.js"],"sourcesContent":["import * as THREE from \"three\";\nimport React, { Suspense, useRef, useEffect, useLayoutEffect } from \"react\";\nimport { Canvas, useFrame, useThree } from \"@react-three/fiber\";\nimport {\n  Sphere,\n  PositionalAudio,\n  OrbitControls,\n  MeshReflectorMaterial,\n  Environment,\n  useTexture,\n  useDepthBuffer,\n  SpotLight,\n  Text,\n  Stats,\n  CameraShake,\n  Html,\n  Loader,\n  Billboard\n} from \"@react-three/drei\";\nimport lerp from \"@14islands/lerp\";\nimport { useControls, Leva } from \"leva\";\nimport { a, useSpring } from \"@react-spring/three\";\n\nimport Effects from \"./Effects\";\n\nlet max = 0;\n\nfunction Analyzer({ started, onStartRequest, sound, shakeController }) {\n  // <Analyzer /> will not run before everything else in the suspense block is resolved.\n  // That means <PositionalAudio/>, which executes async, is ready by the time we're here.\n  // The next frame (useEffect) is guaranteed(!) to access positional-audios ref.\n  const mesh = useRef();\n  const mesh2 = useRef();\n  const mesh3 = useRef();\n  const analyser = useRef();\n  const eq = useRef();\n  // const [hasStarted, setStarted] = React.useState(false);\n  const [hover, setHover] = React.useState(false);\n\n  const { shake } = useControls(\"camera\", {\n    shake: true\n  });\n\n  const onClick = React.useCallback(() => {\n    // introBackdrop.current.visible = false;\n    //setStarted(true);\n    //started && shakeController.current.setIntensity(0.7);\n    onStartRequest && onStartRequest();\n  }, [started, shakeController]);\n\n  useEffect(() => {\n    analyser.current = new THREE.AudioAnalyser(sound.current, 32);\n    eq.current = document.querySelector(\".eq\");\n  }, [sound]);\n\n  useFrame((_, delta) => {\n    const data = analyser.current.getAverageFrequency();\n    const data2 = analyser.current.getFrequencyData();\n    /*\n      mesh.current.material.color.setRGB(\n        Math.min(1, (data2[1] / 255) * 1),\n        Math.min(1, (data2[6] / 255) * 2),\n        Math.min(1, (data2[10] / 255) * 15)\n      );\n      */\n\n    const avg = data / 255;\n    const pulse = Math.pow(data * 0.01, 2);\n\n    if (shake) {\n      shakeController.current.setIntensity(pulse * 0.2);\n    }\n    eq.current.style.transform = `scaleY(${pulse * avg})`;\n\n    if (analyser.current && started) {\n      mesh.current.material.color.setRGB(avg * 1, 0, 0);\n\n      mesh.current.material.roughness = avg;\n      mesh.current.material.metalness = 0 + avg;\n\n      // mesh.current.scale.setScalar(avg2 * 1.2);\n      // mesh.current.scale.setScalar(1 + pulse * pulse);\n      if (mesh.current.scale.x > 1.9) {\n        mesh.current.scale.setScalar(2 + pulse * 0.14);\n      }\n\n      window.intensity = avg;\n\n      // shakeController.current.setIntensity(avg2 * 0.1);\n\n      // console.log('data2', data2)\n      // console.log(\"base\", data);\n\n      // mesh.current.scale.setScalar(\n      //   lerp(mesh.current.scale.x, (data / 255) * 5, 0.01, delta)\n      // );\n\n      mesh2.current.position.x = lerp(\n        mesh2.current.position.x,\n        (data2[2] / 255) * 3 + 1,\n        0.02,\n        delta\n      );\n      mesh2.current.position.z = lerp(\n        mesh2.current.position.z,\n        (data2[6] / 255) * 2 - 1,\n        0.02,\n        delta\n      );\n\n      mesh3.current.position.x = lerp(\n        mesh3.current.position.x,\n        (data2[7] / 255) * -2 - 1,\n        0.02,\n        delta\n      );\n      mesh3.current.position.z = lerp(\n        mesh3.current.position.z,\n        (data2[11] / 255) * 2 + 0.5,\n        0.02,\n        delta\n      );\n\n      // 7 snare\n\n      if (data > max) {\n        max = data;\n        // console.log(\"data\", data, analyser.current.getFrequencyData());\n      }\n    }\n  });\n\n  const sphereSpring = useSpring({\n    \"position-y\": started ? 2.5 : 0.5,\n    \"position-z\": started ? -1 : -0.5,\n    scale: started ? 2 : 1,\n    config: { tension: 10, friction: 10 },\n    delay: 1000\n  });\n\n  const colorSpring = useSpring({\n    \"material-color\": hover ? \"#55ff99\" : \"#C6DA20\",\n    config: { tension: 200, friction: 100 }\n  });\n\n  useEffect(() => {\n    document.body.style.cursor = hover && !started ? \"pointer\" : \"auto\";\n  }, [hover]);\n\n  return (\n    <>\n    </>\n  );\n}\n\nfunction PlaySound({\n  onStartRequest,\n  seek = 0,\n  started,\n  shakeController,\n  url\n}) {\n  // This component creates a suspense block, blocking execution until\n  // all async tasks (in this case PositionAudio) have been resolved.\n  const sound = useRef();\n\n  useLayoutEffect(() => {\n    if (!started) return;\n    console.log(\"started!\");\n    sound.current.play();\n  }, [started]);\n\n  useEffect(() => {\n    // not a real seek - just jumping forward a bit\n    if (!sound.current) return;\n    // console.log(\"seek\", seek, sound.current);\n    sound.current.pause();\n    sound.current.offset = seek;\n    sound.current.play();\n  }, [seek]);\n\n  return (\n    <>\n      <PositionalAudio distance={10} url={url} ref={sound} />\n      <Analyzer\n        started={started}\n        onStartRequest={onStartRequest}\n        sound={sound}\n        shakeController={shakeController}\n      />\n      <Lights started={started} />\n    </>\n  );\n}\n\nfunction Ground(props) {\n  const t = useTexture(\"water-rough1.jpeg\");\n  const f = useTexture(\"floor.jpeg\");\n\n  const groundProps = useControls(\"ground\", {\n    color: \"#fff\",\n    roughness: { value: 1, min: 0, max: 1, steps: 0.01 },\n    metalness: { value: 0.9, min: 0, max: 1, steps: 0.01 },\n    envMapIntensity: { value: 0.01, min: 0, max: 1, steps: 0.01 },\n    blur: { value: 512, min: 0, max: 1024, steps: 16 },\n    mixBlur: { value: 4, min: 0, max: 100, steps: 0.1 },\n    mixStrength: { value: 2, min: 0, max: 10, steps: 0.1 },\n    mixContrast: { value: 1.0, min: 0, max: 10, steps: 0.1 },\n    mirror: { value: 0.33, min: 0, max: 1, steps: 0.1 }\n  });\n\n  useLayoutEffect(() => {\n    t.wrapS = THREE.RepeatWrapping;\n    t.wrapT = THREE.RepeatWrapping;\n    t.repeat.set(5, 5);\n    t.needsUpdate = true;\n  }, [t]);\n\n  return (\n    <mesh rotation-x={Math.PI * -0.5} position-y={0} receiveShadow {...props}>\n      <circleGeometry args={[17, 64]} />\n      {/* <planeGeometry args={[20, 10]} /> */}\n      {/* <meshStandardMaterial\n        color=\"#fff\"\n        roughnessMap={f}\n        roughness={1}\n        metalness={0.2}\n        envMapIntensity={0.05}\n      /> */}\n      <MeshReflectorMaterial\n        roughnessMap={t}\n        resolution={2048}\n        {...groundProps}\n        // color=\"#fff\"\n        // roughnessMap={t}\n        // roughness={1}\n        // metalness={0.9}\n        // envMapIntensity={0.01}\n        // blur={512} // Blur ground reflections (width, heigt), 0 skips blur\n        // mixBlur={10} // How much blur mixes with surface roughness (default = 1)\n        // mixStrength={0.5} // Strength of the reflections\n        // mixContrast={1} // Contrast of the reflections\n        // resolution={2048} // Off-buffer resolution, lower=faster, higher=better quality, slower\n        // mirror={0.5} // Mirror environment, 0 = texture colors, 1 = pick up env colors\n        // depthScale={0} // Scale the depth factor (0 = no depth, default = 0)\n        // minDepthThreshold={0.9} // Lower edge for the depthTexture interpolation (default = 0)\n        // maxDepthThreshold={1} // Upper edge for the depthTexture interpolation (default = 0)\n        // depthToBlurRatioBias={0} // Adds a bias factor to the depthTexture before calculating the blur amount [blurFactor = blurTexture * (depthTexture + bias)]. It accepts values between 0 and 1, default is 0.25. An amount > 0 of bias makes sure that the blurTexture is not too sharp because of the multiplication with the depthTexture\n        //distortion={1} // Amount of distortion based on the distortionMap texture\n        //distortionMap={distortionTexture} // The red channel of this texture is used as the distortion map. Default is null\n        debug={0}\n      />\n    </mesh>\n  );\n}\n\nfunction Lights({ started }) {\n  // This is a super cheap depth buffer that only renders once (frames: 1 is optional!), which works well for static scenes\n  // Spots can optionally use that for realism, learn about soft particles here: http://john-chapman-graphics.blogspot.com/2013/01/good-enough-volumetrics-for-spotlights.html\n  const depthBuffer = useDepthBuffer({ size: 512 });\n  return (\n    <>\n      <MovingSpot\n        depthBuffer={depthBuffer}\n        color=\"#0c8cbf\"\n        position={[4, 5, 2]}\n        started={true}\n      />\n      <MovingSpot\n        depthBuffer={depthBuffer}\n        color=\"#DE356A\"\n        position={[-4, 5, 2]}\n        started={started}\n      />\n    </>\n  );\n}\n\nfunction MovingSpot({ started, vec = new THREE.Vector3(), ...props }) {\n  const light = useRef();\n  const viewport = useThree((state) => state.viewport);\n  useFrame((state) => {\n    light.current.target.position.lerp(\n      vec.set(\n        !started ? -8 : (state.mouse.x * viewport.width) / 2,\n        (state.mouse.y * viewport.height) / 2,\n        -1\n      ),\n      0.02\n    );\n    light.current.target.updateMatrixWorld();\n  });\n  return (\n    <SpotLight\n      castShadow\n      ref={light}\n      penumbra={1}\n      // distance={5}\n      distance={10}\n      // decay={0}\n      decay={0.5}\n      angle={0.25}\n      attenuation={6}\n      anglePower={5}\n      intensity={5}\n      // shadow-camera-far={100}\n      // shadow-camera-fov={80}\n      {...props}\n    />\n  );\n}\n\nfunction Background({ color = \"#202020\" }) {\n  const gl = useThree((s) => s.gl);\n  const bgColor = React.useMemo(() => {\n    const c = new THREE.Color(color).convertSRGBToLinear();\n    gl.setClearColor(c, 1.0);\n    return c;\n  }, [color, gl]);\n  return (\n    <>\n      <color attach=\"background\" args={[bgColor]} />\n      <fog attach=\"fog\" args={[bgColor, 5, 10]} />\n    </>\n  );\n}\n\nfunction CameraParallax({ started, controls, parallax = 1 }) {\n  const camera = useThree((s) => s.camera);\n  // const controls = useThree((s) => s.controls);\n  const get = useThree(({ get }) => get);\n  // console.log(\"controls\", controls, get().controls);\n\n  useFrame((state, delta) => {\n    // console.log(\"c\", controls.current);\n    if (parallax && controls.current) {\n      controls.current.target.x = lerp(\n        controls.current.target.x,\n        !started ? -8 : 0,\n        0.02,\n        delta\n      );\n\n      camera.position.x = lerp(\n        camera.position.x,\n        !started ? -5 : state.mouse.x * parallax + 2,\n        0.02,\n        delta\n      );\n      camera.position.y = lerp(\n        camera.position.y,\n        3 + state.mouse.y * parallax,\n        0.02,\n        delta\n      );\n      // controls.current.update();\n    }\n  });\n\n  return null;\n}\n\nexport default function App() {\n  const controls = useRef();\n  const shakeController = useRef();\n  // const [hasStarted, setStarted] = React.useState(false);\n  const [isUnwrapped, setUnwrap] = React.useState(false);\n  const [seek, setSeek] = React.useState(0);\n\n  const config = {\n    maxYaw: 0, // Max amount camera can yaw in either direction\n    maxPitch: 0.05, // Max amount camera can pitch in either direction\n    maxRoll: 0.05, // Max amount camera can roll in either direction\n    yawFrequency: 0, // Frequency of the the yaw rotation\n    pitchFrequency: 5, // Frequency of the pitch rotation\n    rollFrequency: 0.1, // Frequency of the roll rotation\n    intensity: 0, // initial intensity of the shake\n    decay: true, // should the intensity decay over time\n    decayRate: 0.9, // if decay = true this is the rate at which intensity will reduce at\n    controls // if using orbit controls, pass a ref here so we can update the rotation\n  };\n\n  // const textSpring = useSpring({\n  //   \"position-y\": true ? 0 : 5,\n  //   config: { tension: 10000, friction: 100 },\n  //   delay: 3000\n  // });\n\n  const { fps } = useControls({\n    fps: false\n  });\n\n  return (\n    <>\n      <Canvas\n        shadows\n        dpr={[1, 1.2]}\n        camera={{ position: [-5, 3, 6], fov: 50, near: 1, far: 20 }}\n        gl={{ antialias: false, alpha: false }}\n      >\n        <Background />\n        <Suspense fallback={null}>\n          <PlaySound\n            seek={seek}\n            shakeController={shakeController}\n            //url=\"https://14islands-assets.netlify.app/assets/Kollektiv_Turmstrasse_-_Grillen_Im_Garten_Original_mix.mp3\"\n            url=\"https://14islands-assets.netlify.app/assets/Kollektiv_Turmstrasse_-_Affekt_Original_mix_(djlist.net).mp3\"\n            started={isUnwrapped}\n            onStartRequest={() => setUnwrap(true)}\n          />\n          <OrbitControls\n            ref={controls}\n            target={[-10, 1.8, 0]}\n            enableZoom={false}\n            autoRotate={false}\n            enableRotate={false}\n            enablePan={false}\n            // makeDefault\n          />\n          <CameraShake ref={shakeController} {...config} />\n          <CameraParallax controls={controls} started={isUnwrapped} />\n          <Ground />\n\n\n          <Environment preset=\"warehouse\" />\n        </Suspense>\n        {fps && <Stats />}\n        <Effects />\n      </Canvas>\n      <Loader />\n      <Leva collapsed />\n      <div\n        className={`playing ${isUnwrapped ? \"started\" : \"\"}`}\n        onClick={() => {\n          setSeek(120);\n        }}\n      >\n        <div className=\"eq\"></div>\n        <strong>Kollektiv Turmstrasse</strong> - Affekt (Original mix)\n      </div>\n    </>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}